---
name: commit-workflow
description: "Git コミット〜プッシュまでの作業手順をワークフロー化したスキル。コミットメッセージ作成・意思決定ログ・ユーザーインサイト更新を漏れなく実行する。トリガー例「コミットして」「pushして」「/commit」"
user_invocable: true
---

# Commit Workflow

Git コミット〜プッシュの全手順を漏れなく実行するワークフロー。

## ワークフロー

以下の5ステップを順番に実行する。**ステップを飛ばさないこと。**

### Step 1: 変更確認

```bash
git status
git diff --stat
git log --oneline -5
```

- 変更内容を把握する
- コミット対象ファイルを特定する（.envなど秘匿ファイルは除外）

### Step 2: 意思決定ログ（判断）

セッション中に以下のような判断があったかを振り返る:
- 複数の選択肢から1つを選んだ設計判断
- 技術選定（ライブラリ、API、アーキテクチャ）
- 「なぜこうしたか」がgit diffだけでは読み取れない判断

**該当あり** → `assistant/log/YYYY-MM-DD/decisions.md` に記録（追記）
**該当なし** → スキップ（ファイル作成不要）

記録フォーマット:
```markdown
## [判断のタイトル]
- **選択肢**: A / B / C
- **選択**: A
- **理由**: ...
```

### Step 3: ユーザーインサイト更新（判断）

`assistant/user-insights.md` を読み、セッション中に以下が観察されたか判断する:
- 新たな好み・傾向・思考パターン
- 行動特性の変化
- フィードバック（エージェントへの指摘・要望）

**該当あり** → 該当セクションを更新 + 「観察された変化・成長」に日付付きで追記
**該当なし** → スキップ

### Step 3.5: ライティングルール更新（判断）

セッション中にライティングへの指摘・フィードバックがあったか確認する:
- 文体・トーンへの指摘（「気取りすぎ」「堅苦しい」など）
- 表現・語尾のフィードバック
- 一人称・語り口の修正

**該当あり** → `.claude/rules/writing-style.md` の該当箇所を更新（指摘内容を具体的に反映）
**該当なし** → スキップ

### Step 4: コミット

- 対象ファイルを `git add`（具体的なファイル名指定、`git add .` は避ける）
- Step 2, 3 で更新したファイルも忘れずにステージする
- コミットメッセージを作成:
  - 変更内容が十分伝わる要約
  - 必要に応じて本文に意思決定の理由を含める
  - `Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>` を末尾に付与

### Step 5: プッシュ（ユーザー確認後）

- ユーザーに「プッシュしてよい？」と確認する
- ユーザーが「pushして」「pushまでやって」と最初に指示していた場合は確認不要
- `git push` を実行
- 完了後 `git status` で最終確認

## 注意事項

- **各ステップの判断結果を明示する**（「意思決定ログ: 該当なし」「インサイト更新: 該当あり → 更新済み」のように）
- 秘匿ファイル（`.env`、credentials等）をコミットに含めない
- `node_modules/` 等は .gitignore で除外されていることを前提とする
